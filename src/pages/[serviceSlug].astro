---
import BaseLayout from '../layouts/BaseLayout.astro';
import Breadcrumb from '../components/Breadcrumb.astro';
import { coreServices, business, cities } from '../data/architecture';
import architecture from '../../architecture.json';

const serviceData = architecture.serviceHierarchy.serviceData;

export function getStaticPaths() {
  return coreServices.map(s => ({ params: { serviceSlug: s.slug } }));
}

const { serviceSlug } = Astro.params;
const service = coreServices.find(s => s.slug === serviceSlug);

if (!service) return Astro.redirect('/404');

const data = serviceData[serviceSlug as keyof typeof serviceData] as any;

const crumbs = [
  { label: 'Startseite', url: '/' },
  { label: 'Dienstleistungen', url: '/services' },
  { label: service.name, url: service.url }
];

const schema = {
  '@context': 'https://schema.org',
  '@type': 'Service',
  serviceType: service.name,
  provider: { '@id': `https://${business.domain}/#business` },
  areaServed: cities.map(c => ({ '@type': 'City', name: c.name })),
  description: `${service.name} für lokale Unternehmen in der Schweiz.`
};
---

<BaseLayout title={`${service.name} in ${business.city} — Datanalytico`} description={`${service.name} für lokale Unternehmen in Basel, Zürich und Bern.`} schema={schema}>
  <Breadcrumb crumbs={crumbs} />

  <section class="bg-brand-dark text-white py-16 text-center">
    <div class="container">
      <h1 class="text-white mb-4">{service.name} in {business.city}</h1>
      <p class="text-white/75 text-lg">{service.name} für lokale Unternehmen in Basel, Zürich und Bern.</p>
    </div>
  </section>

  <div class="py-16">
    <div class="container max-w-[900px] mx-auto">
      <section class="mb-12 pb-12 border-b border-gray-200">
        <h2 class="mb-4">Wie hilft {service.name} Ihrem Unternehmen?</h2>
        <p class="leading-relaxed text-brand-text-light">{service.name} ist eine der effektivsten Methoden für lokale Unternehmen in der Schweiz, um Sichtbarkeit auf Google zu gewinnen. Wenn Kunden in Basel, Zürich oder Bern nach Ihrem Angebot suchen, muss Ihr Unternehmen in Google Maps, in den organischen Ergebnissen und in AI-generierten Antworten erscheinen.</p>
        <p class="leading-relaxed text-brand-text-light">Datanalytico liefert {service.name.toLowerCase()} basierend auf verifizierten Schweizer Suchdaten. Wir recherchieren, was Ihre Kunden tatsächlich bei Google eingeben, identifizieren Lücken, die Ihre Wettbewerber übersehen, und erstellen einen Plan, der Ihre Rankings Monat für Monat verbessert.</p>
      </section>

      {data?.processSteps && (
        <section class="mb-12 pb-12 border-b border-gray-200">
          <h2 class="mb-4">Wie sieht unser {service.name} Prozess aus?</h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mt-6">
            {data.processSteps.map((step: any, i: number) => (
              <div class="p-8 bg-brand-bg rounded-xl border border-gray-200">
                <div class="inline-flex items-center justify-center w-9 h-9 bg-primary text-white rounded-full font-bold text-sm mb-4">{i + 1}</div>
                <h3 class="text-[1.0625rem] mb-2">{step.title}</h3>
                <p class="text-[0.9375rem] text-brand-text-light mb-0">{step.description}</p>
              </div>
            ))}
          </div>
        </section>
      )}

      {data?.priceRange && (
        <section class="mb-12 pb-12 border-b border-gray-200">
          <h2 class="mb-4">Was kostet {service.name} in der Schweiz?</h2>
          <p class="leading-relaxed text-brand-text-light">
            {service.name} von Datanalytico kostet typischerweise zwischen CHF {data.priceRange.min.toLocaleString()} und CHF {data.priceRange.max.toLocaleString()} pro {data.priceRange.period === 'month' ? 'Monat' : data.priceRange.period}.
            Die Preise hängen vom Wettbewerbsniveau, der Anzahl der Zielstädte und dem Umfang ab. Rufen Sie <a href={business.phoneTel}>{business.phone}</a> an für ein Angebot.
          </p>
        </section>
      )}

      {service.children.length > 0 && (
        <section class="mb-12 pb-12 border-b border-gray-200">
          <h2 class="mb-4">Spezialisierte Dienstleistungen</h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-6">
            {service.children.map(child => (
              <a href={`${import.meta.env.BASE_URL}${child.url.slice(1)}`} class="block p-6 bg-white border border-gray-200 rounded-lg hover:border-primary hover:shadow-sm no-underline transition-all">
                <h3 class="text-base mb-1 text-brand-dark">{child.name}</h3>
                <span class="text-sm text-primary font-medium">Mehr erfahren &rarr;</span>
              </a>
            ))}
          </div>
        </section>
      )}

      <section class="mb-12 pb-12 border-b border-gray-200">
        <h2 class="mb-4">{service.name} nach Stadt</h2>
        <div class="flex flex-col gap-2 mt-4">
          {cities.map(city => (
            <a href={`${import.meta.env.BASE_URL}areas/${city.slug}/${serviceSlug}`} class="inline-block py-2 px-4 bg-brand-bg border border-gray-200 rounded-lg font-medium text-[0.9375rem] hover:border-primary hover:bg-white no-underline transition-all">
              {service.name} in {city.name} &rarr;
            </a>
          ))}
        </div>
      </section>

      <section class="text-center p-12 bg-brand-bg rounded-xl my-12">
        <h2 class="mb-2">Bereit, Ihre lokalen Rankings zu verbessern?</h2>
        <p class="text-brand-text-light mb-6">Datanalytico liefert {service.name.toLowerCase()} mit messbaren Ergebnissen. Keine Langzeitverträge erforderlich.</p>
        <div class="flex gap-4 justify-center flex-wrap">
          <a href={business.phoneTel} class="btn btn--accent">Anrufen {business.phone}</a>
          <a href={`${import.meta.env.BASE_URL}contact`} class="btn btn--primary">Kostenlose Analyse</a>
        </div>
      </section>
    </div>
  </div>
</BaseLayout>
