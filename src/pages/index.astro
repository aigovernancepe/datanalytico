---
import BaseLayout from '../layouts/BaseLayout.astro';
import { business, coreServices, cities, serviceAreas } from '../data/architecture';
import homepageContent from '../../homepage-content.json';

const { hero, whyChooseUs, capsuleContent, services, about, faqs, finalCta } = homepageContent;

const whyIcons = [
  '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"/><path d="M7 16l4-8 4 4 4-8"/></svg>',
  '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 1 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>',
  '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>',
  '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/></svg>',
];

const schema = [
  {
    '@context': 'https://schema.org',
    '@type': 'ProfessionalService',
    '@id': `https://${business.domain}/#business`,
    name: business.name,
    telephone: business.phone,
    email: business.email,
    url: `https://${business.domain}/`,
    address: {
      '@type': 'PostalAddress',
      addressLocality: business.city,
      addressRegion: business.state,
      addressCountry: business.country
    },
    areaServed: cities.map(c => ({ '@type': 'City', name: c.name })),
    sameAs: []
  },
  {
    '@context': 'https://schema.org',
    '@type': 'FAQPage',
    mainEntity: faqs.map((f: any) => ({
      '@type': 'Question',
      name: f.question,
      acceptedAnswer: { '@type': 'Answer', text: f.answer }
    }))
  }
];
---

<BaseLayout title="Datanalytico — Local SEO Agentur | Basel, Schweiz" description={hero.subheadline} schema={schema}>
  <!-- Hero -->
  <section class="bg-gradient-to-br from-brand-dark to-[#162a45] text-white py-16 md:py-20 overflow-hidden">
    <div class="container">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 lg:gap-12 items-center">
        <!-- Left column: text, CTA, trust strip -->
        <div class="text-left">
          <h1 class="mb-6">
            <span class="block text-white/80 text-lg md:text-xl font-semibold tracking-wide mb-3" data-i18n="home.hero.h1.top">{hero.h1Top}</span>
            <span class="block text-white text-[2.25rem] md:text-[2.75rem] lg:text-[3.25rem] font-black leading-tight tracking-tight"><span data-i18n="home.hero.h1.rank">{hero.h1Rank}</span> <span class="text-accent" data-i18n="home.hero.h1.leads">{hero.h1Leads}</span></span>
          </h1>
          <p class="text-white/80 text-lg max-w-[540px] mb-8" data-i18n="home.hero.sub">{hero.subheadline}</p>
          <div class="flex gap-4 flex-wrap mb-8">
            <a href={hero.primaryCta.action} class="btn btn--accent" data-i18n="home.hero.cta1" data-track-cta="hero_free_seo_review" data-track-location="hero">{hero.primaryCta.text}</a>
            <a href={`${import.meta.env.BASE_URL}contact`} class="btn btn--outline" data-i18n="home.hero.cta2" data-track-cta="hero_see_how_we_work">{hero.secondaryCta.text}</a>
          </div>
          <div class="flex flex-wrap gap-x-8 gap-y-4 pt-6 border-t border-white/15">
            {hero.trustStrip.map((signal: string, i: number) => (
              <span class="flex items-center gap-1 text-[0.8125rem] text-white/70">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="text-accent flex-shrink-0"><polyline points="20 6 9 17 4 12" /></svg>
                <span data-i18n={`home.hero.trust${i + 1}`}>{signal}</span>
              </span>
            ))}
          </div>
        </div>
        <!-- Right column: hero image -->
        <div class="hidden lg:flex justify-center items-center">
          <img
            src={`${import.meta.env.BASE_URL}brand/seo-berater-basel-zuerich-bern-mobile.webp`}
            alt="SEO Berater für Basel, Zürich und Bern — Datanalytico Local SEO Agentur hilft Schweizer KMU, auf Google Maps und in der lokalen Suche sichtbar zu ranken"
            width="540"
            height="270"
            loading="eager"
            class="w-full max-w-[540px] h-auto rounded-2xl shadow-2xl"
          />
        </div>
      </div>
    </div>
  </section>

  <!-- Why Choose Us -->
  <section class="py-20 bg-brand-bg">
    <div class="container">
      <div class="text-center mb-14">
        <span class="inline-block text-accent font-semibold text-xs uppercase tracking-[0.15em] mb-3" data-i18n="home.why.label">Warum Datanalytico</span>
        <h2 data-i18n="home.why.title">Warum Unternehmen Datanalytico wählen</h2>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
        {whyChooseUs.map((item: any, i: number) => (
          <div class="group relative bg-white rounded-2xl p-8 shadow-[0_1px_3px_rgba(0,0,0,0.04)] hover:shadow-[0_12px_32px_rgba(0,0,0,0.08)] transition-all duration-300 hover:-translate-y-1 overflow-hidden">
            <div class="absolute top-0 left-0 right-0 h-[3px] bg-gradient-to-r from-primary to-accent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            <div class="w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center mb-5 text-primary group-hover:bg-primary/15 transition-colors duration-300">
              <Fragment set:html={whyIcons[i]} />
            </div>
            <h3 class="text-[1.0625rem] font-semibold mb-3" data-i18n={`home.why.h${i + 1}`}>{item.headline}</h3>
            <p class="text-brand-text-light text-[0.875rem] leading-relaxed mb-0" data-i18n={`home.why.d${i + 1}`}>{item.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Lead Capture Form -->
  <section class="py-16 bg-primary text-white">
    <div class="container">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-[800px] mx-auto">
        <div>
          <h2 class="text-white" data-i18n="home.form.title">Kostenlose Local SEO Analyse erhalten</h2>
          <p class="text-white/85" data-i18n="home.form.desc">Erzählen Sie uns von Ihrem Unternehmen und wir zeigen Ihnen genau, wo Sie in der lokalen Suche stehen — und was nötig ist, um aufzusteigen.</p>
        </div>
        <form class="flex flex-col gap-4" data-track-form="homepage_lead_form">
          <input type="text" placeholder="Ihr Name" data-i18n-placeholder="home.form.name" class="w-full py-3 px-4 border border-white/30 rounded-lg bg-white/10 text-white font-sans text-[0.9375rem] placeholder:text-white/50 focus:outline-none focus:border-accent" required />
          <input type="tel" placeholder="Telefonnummer" data-i18n-placeholder="home.form.phone" class="w-full py-3 px-4 border border-white/30 rounded-lg bg-white/10 text-white font-sans text-[0.9375rem] placeholder:text-white/50 focus:outline-none focus:border-accent" required />
          <input type="email" placeholder="E-Mail-Adresse" data-i18n-placeholder="home.form.email" class="w-full py-3 px-4 border border-white/30 rounded-lg bg-white/10 text-white font-sans text-[0.9375rem] placeholder:text-white/50 focus:outline-none focus:border-accent" required />
          <select class="w-full py-3 px-4 border border-white/30 rounded-lg bg-white/10 text-white font-sans text-[0.9375rem] focus:outline-none focus:border-accent" required>
            <option value="" disabled selected data-i18n="home.form.service">Dienstleistung auswählen</option>
            {coreServices.map(s => (
              <option value={s.slug} class="text-brand-dark">{s.name}</option>
            ))}
          </select>
          <textarea placeholder="Erzählen Sie uns von Ihrem Unternehmen" data-i18n-placeholder="home.form.message" class="w-full py-3 px-4 border border-white/30 rounded-lg bg-white/10 text-white font-sans text-[0.9375rem] placeholder:text-white/50 focus:outline-none focus:border-accent resize-y" rows="3"></textarea>
          <button type="submit" class="btn btn--accent btn--full" data-i18n="home.form.submit">Kostenlose Analyse senden</button>
        </form>
      </div>
    </div>
  </section>

  <!-- Services -->
  <section class="py-16">
    <div class="container">
      <h2 class="text-center mb-8" data-i18n="home.services.title">Was wir für lokale Unternehmen tun</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
        {services.map((svc: any) => {
          const slug = svc.slug === 'google-ads' ? 'ppc-google-ads' : svc.slug;
          return (
            <div class="p-8 bg-white border border-gray-200 rounded-xl hover:border-primary hover:shadow-md transition-all">
              <h3 class="mb-2"><a href={`${import.meta.env.BASE_URL}${slug}`} class="text-brand-dark hover:text-primary no-underline" data-track-service={svc.name} data-i18n={`home.svcName.${svc.slug}`}>{svc.name}</a></h3>
              <p class="text-brand-text-light text-[0.9375rem] leading-relaxed" data-i18n={`home.svc.${svc.slug}`}>{svc.description}</p>
              <a href={`${import.meta.env.BASE_URL}${slug}`} class="font-semibold text-sm text-primary" data-track-service={svc.name}><span data-i18n="home.services.learnMore">Mehr erfahren</span> &rarr;</a>
            </div>
          );
        })}
      </div>
    </div>
  </section>

  <!-- Capsule Content -->
  <section class="py-16 bg-white">
    <div class="container">
      {capsuleContent.blocks.map((block: any, i: number) => (
        <div class:list={['max-w-[800px] mx-auto mb-12 pb-12 border-b border-gray-200', { 'border-b-0 mb-0 pb-0': i === capsuleContent.blocks.length - 1 }]}>
          <h2 class="text-[1.375rem] mb-4" data-i18n={`home.cap.h${i + 1}`}>{block.h2}</h2>
          <p class="text-brand-text-light leading-relaxed mb-0" data-i18n={`home.cap.p${i + 1}`}>{block.capsule}</p>
        </div>
      ))}
    </div>
  </section>

  <!-- Service Areas -->
  <section class="py-16">
    <div class="container">
      <h2 class="text-center mb-8" data-i18n="home.areas.title">Einzugsgebiete</h2>
      <p class="text-center text-brand-text-light max-w-[600px] mx-auto mb-8" data-i18n="home.areas.desc">Mit Sitz in {business.city}, betreuen wir Unternehmen in den wichtigsten Wirtschaftszentren der Schweiz.</p>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
        {cities.map(city => (
          <a href={`${import.meta.env.BASE_URL}areas/${city.slug}`} class="block p-8 bg-white border border-gray-200 rounded-xl hover:border-primary hover:shadow-md transition-all no-underline" data-track-area={city.name}>
            <h3 class="mb-1">{city.name}</h3>
            <p class="text-[0.8125rem] text-primary mb-2">{city.canton} &middot; {city.population.toLocaleString('de-CH')} <span data-i18n="home.areas.residents">Einwohner</span></p>
            <p class="text-[0.9375rem] text-brand-text-light mb-0" data-i18n={`home.areas.${city.slug}.desc`}>{city.description}</p>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- About -->
  <section class="py-16 bg-white">
    <div class="container">
      <div class="max-w-[800px] mx-auto text-center">
        <h2 data-i18n="home.about.title">{about.heading}</h2>
        <p class="text-brand-text-light leading-relaxed mb-8" data-i18n="home.about.content">{about.content}</p>
        <a href={`${import.meta.env.BASE_URL}about`} class="btn btn--primary" data-track-cta="homepage_about_link"><span data-i18n="home.about.link">Über Datanalytico</span> &rarr;</a>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="py-16">
    <div class="container">
      <h2 class="text-center mb-8" data-i18n="home.faq.title">Häufig gestellte Fragen</h2>
      <div class="max-w-[800px] mx-auto">
        {faqs.map((faq: any, i: number) => (
          <details class="border-b border-gray-200 group" data-track-faq={faq.question}>
            <summary class="w-full flex justify-between items-center py-6 text-base font-semibold text-brand-dark cursor-pointer list-none hover:text-primary gap-4">
              <span data-i18n={`home.faq.q${i + 1}`}>{faq.question}</span>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0 transition-transform group-open:rotate-180"><polyline points="6 9 12 15 18 9" /></svg>
            </summary>
            <div class="pb-6">
              <p class="text-brand-text-light leading-relaxed mb-0" data-i18n={`home.faq.a${i + 1}`}>{faq.answer}</p>
            </div>
          </details>
        ))}
      </div>
    </div>
  </section>

  <!-- Locations -->
  <section class="py-16 bg-brand-dark text-white">
    <div class="container">
      <h2 class="text-center text-white mb-8" data-i18n="home.locations.title">Standorte, die wir betreuen</h2>
      <div class="flex justify-center gap-6 flex-wrap">
        {serviceAreas.map(area => (
          <a href={`${import.meta.env.BASE_URL}areas/${area.toLowerCase()}`} class="text-white/70 text-lg font-semibold px-6 py-2 border border-white/20 rounded-lg hover:text-white hover:border-primary hover:bg-primary/20 no-underline transition-all" data-track-area={area}>
            {area}
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- Final CTA -->
  <section class="py-16 bg-accent text-brand-dark">
    <div class="container text-center max-w-[700px] mx-auto">
      <h2 class="text-3xl mb-4" data-i18n="home.cta.title">{finalCta.headline}</h2>
      <p class="text-[1.0625rem] mb-8" data-i18n="home.cta.desc">{finalCta.subtext}</p>
      <div class="flex gap-4 justify-center flex-wrap">
        <a href={`tel:${business.phone.replace(/\s/g, '')}`} class="btn btn--dark btn--lg" data-track-cta="homepage_final_call" data-track-location="homepage_final_cta"><span data-i18n="home.cta.call">Anrufen</span> {business.phone}</a>
        <a href={`${import.meta.env.BASE_URL}contact`} class="btn btn--outline-dark btn--lg" data-i18n="home.cta.message" data-track-cta="homepage_final_message">Nachricht senden</a>
      </div>
    </div>
  </section>
</BaseLayout>
